    public static long getUsedMemory() {
        long memAfterGC  = memUsed();
        long memBeforeGC = memAfterGC+1;
        while (memAfterGC < memBeforeGC) {
            memBeforeGC = memAfterGC;
            for (int i = 0; i < 5; ++i) {
                TightDB.gcGuaranteed();
                System.runFinalization();
                Thread.yield();
            }
            memAfterGC = memUsed();
        }
        return memBeforeGC;
    }


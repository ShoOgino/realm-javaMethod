    public ColumnType getType() {
        if (value == null) {
            return ColumnType.ColumnTypeTable;
        }
        if (value instanceof String)
            return ColumnType.ColumnTypeString;
        else if (value instanceof Long)
            return ColumnType.ColumnTypeInt;
        else if (value instanceof Float)
            return ColumnType.ColumnTypeFloat;
        else if (value instanceof Double)
            return ColumnType.ColumnTypeDouble;
        else if (value instanceof Date)
            return ColumnType.ColumnTypeDate;
        else if (value instanceof Boolean)
            return ColumnType.ColumnTypeBool;
        else if (value instanceof ByteBuffer || (value instanceof byte[])) {
            return ColumnType.ColumnTypeBinary;
        }

        throw new IllegalStateException("Unknown column type!");
    }


    @Test
    @UiThreadTest
    public void uploadAllLocalChanges_withTimeout_throwsOnUiThread() throws InterruptedException {
        Realm realm = Realm.getInstance(configuration);
        try {
            app.getSync().getOrCreateSession(configuration).uploadAllLocalChanges(30, TimeUnit.SECONDS);
            fail("Should throw an IllegalStateException on Ui Thread");
        } catch (IllegalStateException ignored) {
        } finally {
            realm.close();
        }
    }


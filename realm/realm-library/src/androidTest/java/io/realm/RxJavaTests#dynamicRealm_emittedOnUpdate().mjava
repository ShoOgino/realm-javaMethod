    @Test
    @RunTestInLooperThread
    public void dynamicRealm_emittedOnUpdate() {
        final DynamicRealm dynamicRealm = DynamicRealm.getInstance(looperThread.getConfiguration());
        final AtomicInteger subscriberCalled = new AtomicInteger(0);
        subscription = dynamicRealm.asFlowable().subscribe(new Consumer<DynamicRealm>() {
            @Override
            public void accept(DynamicRealm dynamicRealm) throws Exception {
                if (subscriberCalled.incrementAndGet() == 2) {
                    dynamicRealm.close();
                    looperThread.testComplete();
                }
            }
        });

        dynamicRealm.beginTransaction();
        dynamicRealm.createObject("AllTypes");
        dynamicRealm.commitTransaction();
    }


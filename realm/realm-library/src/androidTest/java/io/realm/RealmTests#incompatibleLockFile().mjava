    @Test
    public void incompatibleLockFile() throws IOException {
        // Replace .lock file with a corrupted one
        File lockFile = new File(realmConfig.getPath() + ".lock");
        assertTrue(lockFile.exists());
        FileOutputStream fooStream = new FileOutputStream(lockFile, false);
        fooStream.write("Boom".getBytes());
        fooStream.close();

        try {
            // This will try to open a second SharedGroup which should fail when the .lock file is corrupt
            DynamicRealm.getInstance(realm.getConfiguration());
            fail();
        } catch (RealmError expected) {
            assertTrue(expected.getMessage().contains("Info size doesn't match"));
        } finally {
            lockFile.delete();
        }
    }


    @Test
    public void distinct() {
        Collection collection = new Collection(sharedRealm, table.where().lessThan(new long[] {2}, oneNullTable, 4));

        SortDescriptor distinctDescriptor = SortDescriptor.getTestInstance(table, new long[] {2});
        Collection collection2 = collection.distinct(distinctDescriptor);

        // A new native Results should be created.
        assertTrue(collection.getNativePtr() != collection2.getNativePtr());
        assertEquals(3, collection.size());
        assertEquals(2, collection2.size());

        assertEquals(3, collection2.getUncheckedRow(0).getLong(2));
        assertEquals(1, collection2.getUncheckedRow(1).getLong(2));
    }


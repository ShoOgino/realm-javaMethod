    @Test
    public void getInstanceForDistinct_shouldThrowOnInvalidField() {
        List<RealmFieldType> types = new ArrayList<RealmFieldType>();
        for (RealmFieldType type : RealmFieldType.values()) {
            if (!SortDescriptor.validFieldTypesForDistinct.contains(type) &&
                    type != RealmFieldType.UNSUPPORTED_DATE &&
                    type != RealmFieldType.UNSUPPORTED_TABLE&&
                    type != RealmFieldType.UNSUPPORTED_MIXED) {
                if (type == RealmFieldType.LIST || type == RealmFieldType.OBJECT) {
                    table.addColumnLink(type, type.name(), table);
                } else {
                    table.addColumn(type, type.name());
                }
                types.add(type);
            }
        }

        for (RealmFieldType type : types) {
            try {
                SortDescriptor.getInstanceForDistinct(table, type.name());
                fail();
            } catch (IllegalArgumentException ignored) {
                assertTrue(ignored.getMessage().contains("Distinct is not supported"));
            }
        }
    }


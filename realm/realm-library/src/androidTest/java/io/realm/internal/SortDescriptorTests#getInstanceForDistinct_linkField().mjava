    @Test
    public void getInstanceForDistinct_linkField() {
        for (RealmFieldType type : SortDescriptor.validFieldTypesForDistinct) {
            long column = table.addColumn(type, type.name());
            table.addSearchIndex(column);
        }
        RealmFieldType objectType = RealmFieldType.OBJECT;
        long columnLink = table.addColumnLink(objectType, objectType.name(), table);

        long i = 0;
        for (RealmFieldType type : SortDescriptor.validFieldTypesForDistinct) {
            SortDescriptor sortDescriptor = SortDescriptor.getInstanceForDistinct(table,
                    String.format("%s.%s", objectType.name(), type.name()));
            assertEquals(2, sortDescriptor.getColumnIndices()[0].length);
            assertEquals(columnLink, sortDescriptor.getColumnIndices()[0][0]);
            assertEquals(i, sortDescriptor.getColumnIndices()[0][1]);
            assertNull(sortDescriptor.getAscendings());
            i++;
        }
    }


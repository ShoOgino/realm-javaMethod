        @Override
        public boolean handleMessage(Message message) {
            // Due to how a ConcurrentHashMap iterator is created we cannot be sure that other threads are
            // aware when this threads handler is removed before they send messages to it. We don't wish to synchronize
            // access to the handlers as they are the prime mean of notifying about updates. Instead we make sure
            // that if a message does slip though (however unlikely), it will not try to update a SharedGroup that no
            // longer exists. `sharedGroupManager` will only be null if a Realm is really closed.
            if (message.what == REALM_CHANGED && sharedGroupManager != null) {
                sharedGroupManager.advanceRead();
                sendNotifications();
            }
            return true;
        }


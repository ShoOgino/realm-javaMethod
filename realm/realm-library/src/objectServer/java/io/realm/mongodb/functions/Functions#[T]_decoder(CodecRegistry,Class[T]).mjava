    private static <T> Decoder<T> decoder(CodecRegistry codecRegistry, Class<T> clz) {
        try {
            return codecRegistry.get(clz);
        } catch (Exception e) {
            throw new ObjectServerError(ErrorCode.BSON_CODEC_NOT_FOUND, "Could not resolve decoder for " + clz.getName(), e);
        }
    }


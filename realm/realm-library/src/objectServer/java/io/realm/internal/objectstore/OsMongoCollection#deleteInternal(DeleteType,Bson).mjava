    private DeleteResult deleteInternal(final DeleteType type, final Bson filter) {
        AtomicReference<DeleteResult> success = new AtomicReference<>(null);
        AtomicReference<ObjectServerError> error = new AtomicReference<>(null);
        OsJNIResultCallback<DeleteResult> callback = new OsJNIResultCallback<DeleteResult>(success, error) {
            @Override
            protected DeleteResult mapSuccess(Object result) {
                return new DeleteResult((Long) result);
            }
        };

        String jsonDocument = JniBsonProtocol.encode(filter, codecRegistry);
        switch (type) {
            case ONE:
                nativeDeleteOne(nativePtr, jsonDocument, callback);
                break;
            case MANY:
                nativeDeleteMany(nativePtr, jsonDocument, callback);
                break;
        }
        return ResultHandler.handleResult(success, error);
    }


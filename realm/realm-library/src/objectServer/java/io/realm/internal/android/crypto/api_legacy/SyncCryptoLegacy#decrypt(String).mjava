    @Override
    public String decrypt(String cipherText) throws KeyStoreException {
        byte[] keyBytes = get(alias);
        if (keyBytes == null) {
            return null;
        }
        SecretKeySpec key = new SecretKeySpec(keyBytes, "AES");

        try {
            String[] fields = cipherText.split(DELIMITER);
            if (fields.length != 2) {
                throw new IllegalArgumentException("Invalid encrypted text format");
            }

            byte[] iv = Base64.from(fields[0]);
            byte[] cipherBytes = Base64.from(fields[1]);
            Cipher cipher = CipherFactory.get();
            IvParameterSpec ivParams = new IvParameterSpec(iv);
            cipher.init(Cipher.DECRYPT_MODE, key, ivParams);
            byte[] plaintext = cipher.doFinal(cipherBytes);
            return new String(plaintext, "UTF-8");
        } catch (GeneralSecurityException e) {
            throw new KeyStoreException(e);
        } catch (UnsupportedEncodingException e) {
            throw new KeyStoreException(e);
        }
    }


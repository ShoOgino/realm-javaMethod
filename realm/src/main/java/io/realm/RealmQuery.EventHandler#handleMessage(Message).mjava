        @Override
        public void handleMessage(Message msg) {
            if (!asyncRequest.isCancelled()) {
                switch (msg.what) {
                    case MSG_SUCCESS:
                        handleSuccess(msg);
                        break;
                    case MSG_ERROR:
                        handleError(msg);
                        break;
                    case MSG_UNREACHABLE_VERSION: {
                        handleUnreachableVersion(msg);
                        break;
                    }
                    case MSG_ADVANCE_READ: {
                        handleAdvanceRead(msg);
                        break;
                    }
                }

            } else {
                // in case we didn't have the chance to import the different handovers(because the query was cancelled/crash)
                // we need to manually free those resources to avoid memory leak
                releaseHandoverResources();
            }
        }


        @Override
        public void handleMessage(Message msg) {
            if (!asyncRequest.isCancelled()) {
                switch (msg.what) {
                    case MSG_SUCCESS:
                        Bundle bundle = msg.getData();
                        try {
                            // import & create a RealmResults
                            // importHandoverTableView may throw UnreachableVersionException
                            RealmResults<E> resultList = new RealmResults<E>(realm,
                                    query.importHandoverTableView(bundle.getLong(TABLE_VIEW_POINTER_ARG), bundle.getLong(CALLER_SHARED_GROUP_POINTER_ARG)),
                                    clazz);
                            callback.onSuccess(resultList);

                        } catch (UnreachableVersionException e) {
                            if (retryPolicy.shouldRetry()) {
                                findAll(callback);
                            } else {
                                callback.onError(e);
                            }
                        } catch (Exception e) {
                            callback.onError(e);
                        }
                        break;

                    case MSG_UNREACHABLE_VERSION:
                        if (retryPolicy.shouldRetry()) {
                            findAll(callback);
                        }
                        break;
                    case MSG_ERROR:
                        callback.onError((Exception) msg.obj);
                        break;

                    case MSG_ADVANCE_READ:
                        ((Realm.DebugQueryCallback<E>)callback).onBackgroundQueryCompleted(realm);
                        break;
                }
            }
        }


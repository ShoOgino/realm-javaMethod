    public void promoteToWrite() {
        assertNotClosed();
        if (!immutable) {
            throw new IllegalStateException("Nested transactions are not allowed. Use commitTransaction() after each beginTransaction().");
        }
        immutable = false;
        parent.promoteToWrite();
    }


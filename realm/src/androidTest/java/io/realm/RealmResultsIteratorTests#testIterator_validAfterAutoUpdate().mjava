    // Query iterator should still be valid if we modify Realm after query but before iterator is
    // fetched.
    public void testIterator_validAfterAutoUpdate() {
        RealmResults<AllTypes> result = testRealm.allObjects(AllTypes.class);

        testRealm.beginTransaction();
        result.removeLast();
        testRealm.commitTransaction();

        long sum = 0;
        for (AllTypes obj : result) {
            sum += obj.getColumnLong();
        }

        assertEquals(sum(0, TEST_DATA_SIZE - 2), sum);
    }


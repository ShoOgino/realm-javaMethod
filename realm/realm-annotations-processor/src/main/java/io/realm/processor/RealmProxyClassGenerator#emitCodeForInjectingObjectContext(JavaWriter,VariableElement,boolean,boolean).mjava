    private void emitCodeForInjectingObjectContext(JavaWriter writer, VariableElement field, boolean isSetter, boolean isPrimaryKey) throws IOException {
        // if invoked from model's constructor, inject BaseRealm and Row
        writer.beginControlFlow("if (proxyState == null)");
        {
            writer.emitSingleLineComment("Called from model's constructor. Inject context.");
            writer.emitStatement("injectObjectContext()");
        }
        writer.endControlFlow();
        writer.emitEmptyLine();

        if (isSetter) {
            writer.beginControlFlow("if (proxyState.isUnderConstruction())");
            {
                if (isPrimaryKey) {
                    writer.emitSingleLineComment("default value of the primary key is always ignored.");
                    writer.emitStatement("return");
                } else {
                    writer.beginControlFlow("if (!proxyState.getAcceptDefaultValue$realm())")
                            .emitStatement("return")
                            .endControlFlow();
                    if (Utils.isRealmModel(field)) {
                        // check excludeFields
                        writer.beginControlFlow("if (proxyState.getExcludeFields$realm().contains(\"%1$s\"))",
                                field.getSimpleName().toString())
                                .emitStatement("return")
                                .endControlFlow();
                        writer.beginControlFlow("if (value != null && !RealmObject.isManaged(value))")
                                .emitStatement("value = ((Realm) proxyState.getRealm$realm()).copyToRealm(value)")
                                .endControlFlow();
                    } else if (Utils.isRealmList(field)) {
                        // check excludeFields
                        writer.beginControlFlow("if (proxyState.getExcludeFields$realm().contains(\"%1$s\"))",
                                field.getSimpleName().toString())
                                .emitStatement("return")
                                .endControlFlow();
                        final String modelFqcn = Utils.getGenericTypeQualifiedName(field);
                        writer.beginControlFlow("if (value != null && !value.isManaged())")
                                .emitStatement("final Realm realm = (Realm) proxyState.getRealm$realm()")
                                .emitStatement("final RealmList<%1$s> original = value", modelFqcn)
                                .emitStatement("value = new RealmList<%1$s>()", modelFqcn)
                                .beginControlFlow("for (%1$s item : original)", modelFqcn)
                                    .beginControlFlow("if (item == null || RealmObject.isManaged(item))")
                                        .emitStatement("value.add(item)")
                                    .nextControlFlow("else")
                                        .emitStatement("value.add(realm.copyToRealm(item))")
                                    .endControlFlow()
                                .endControlFlow()
                            .endControlFlow();
                    }
                }
            }
            writer.endControlFlow()
                    .emitEmptyLine();
        }
    }

